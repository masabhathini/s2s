preprocess_defaults: &preprocess_defaults
  remap:
    method: nn
    res: 0.04

pctl_defaults: &pctl_defaults
  - { opr: pctl, arg: 0 }
  - { opr: pctl, arg: 20 }
  - { opr: pctl, arg: 40 }
  - { opr: pctl, arg: 50 }
  - { opr: pctl, arg: 60 }
  - { opr: pctl, arg: 80 }
  - { opr: pctl, arg: 100 }

range_defaults: &range_defaults
  - opr: min
  - opr: median
  - opr: max

temp_gtc: &temp_gtc
  - { opr: prob_gtc, arg: 37 }
  - { opr: prob_gtc, arg: 40 }
  - { opr: prob_gtc, arg: 43 }
  - { opr: prob_gtc, arg: 46 }
  - { opr: prob_gtc, arg: 49 }
  - { opr: prob_gtc, arg: 52 }

temp_ltc: &temp_ltc
  - { opr: prob_ltc, arg: 0 }
  - { opr: prob_ltc, arg: 3 }
  - { opr: prob_ltc, arg: 6 }
  - { opr: prob_ltc, arg: 9 }
  - { opr: prob_ltc, arg: 12 }
  - { opr: prob_ltc, arg: 15 }

fields:
  T2:
    preprocess:
      <<: *preprocess_defaults
      unit_conversion:
        addc: -273.15
        units: degC

    stat:
      - time_coarsen: null
        ens_stats:
          pctl: *pctl_defaults
        file_type:
          pctl: zarr

      - time_coarsen: daymax
        ens_stats:
          range: *range_defaults
          prob_gtc: *temp_gtc
        file_type:
          range: zarr
          prob_gtc: zarr

      - time_coarsen: daymin
        ens_stats:
          range: *range_defaults
          prob_ltc: *temp_ltc
        file_type:
          range: zarr
          prob_ltc: zarr

      - time_coarsen: weekmean
        ens_stats:
          median:
            - opr: median
          efi:
            - opr: efi
          sotp:
            - opr: sotp
          sotn:
            - opr: sotn
          fcstmembers:
            - opr: members
          rfmembers:
            - opr: rfmembers

        file_type:
          median: nc
          efi: nc
          sotp: nc
          sotn: nc
          ensmembers: zarr
