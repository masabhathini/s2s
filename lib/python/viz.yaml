preprocess_defaults: &preprocess_defaults
  remap:
    method: nn
    res: 0.04

pctl_defaults: &pctl_defaults
  - { opr: pctl, arg: 0 }
  - { opr: pctl, arg: 20 }
  - { opr: pctl, arg: 40 }
  - { opr: pctl, arg: 50 }
  - { opr: pctl, arg: 60 }
  - { opr: pctl, arg: 80 }
  - { opr: pctl, arg: 100 }

range_defaults: &range_defaults
  - opr: min
  - opr: median
  - opr: max

temp_gtc: &temp_gtc
  - { opr: prob_gtc, arg: 37 }
  - { opr: prob_gtc, arg: 40 }
  - { opr: prob_gtc, arg: 43 }
  - { opr: prob_gtc, arg: 46 }
  - { opr: prob_gtc, arg: 49 }
  - { opr: prob_gtc, arg: 52 }

temp_ltc: &temp_ltc
  - { opr: prob_ltc, arg: 0 }
  - { opr: prob_ltc, arg: 3 }
  - { opr: prob_ltc, arg: 6 }
  - { opr: prob_ltc, arg: 9 }
  - { opr: prob_ltc, arg: 12 }
  - { opr: prob_ltc, arg: 15 }

fields:
  T2:
    preprocess:
      <<: *preprocess_defaults
      unit_conversion:
        addc: -273.15
        units: degC

    stat:
      - time_coarsen: null
        ens_stats:
          enspclt: *pctl_defaults
        file_type:
          enspctl: zarr
      - time_coarsen: daymax
        ens_stats:
          ensrange: *range_defaults
          ensprob_gtc: *temp_gtc
        file_type:
          ensrange: zarr
          ensprob_gtc: zarr

      - time_coarsen: daymin
        ens_stats:
          ensrange: *range_defaults
          ensprob_ltc: *temp_ltc
        file_type:
          ensrange: zarr
          ensprob_ltc: zarr

      - time_coarsen: weekmean
        ens_stats:
          ensmedian:
            - opr: median

        file_type:
          ensmedian: nc
